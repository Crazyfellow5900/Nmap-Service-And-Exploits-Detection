#!/bin/bash 

#this is basic scan for nmap service version detection,which scans all the 65535 ports#

#please make sure that if there is any firewall or IDS/IPS then the results will not be shown#

#you can simply scan this using command nmap -T4 -sV -p- -A<target ip>#

#here in some rare situations we find some errors like blocking  our pings so to rectify them i have just used -Pn #


if [ "$1" == ""]
then
	echo "ERROR"
	echo "Syntax: ./nmap.sh <target ip>"
#this reveals that if you give a wrong command then it throws the error as seen above#
	
else
	nmap -T4 -Pn -sV -p- -A  $1 -oX base.xml;
#here we have just scan the target ip and the results of the scan was saved to base.txt#
	cat base.xml | grep "open" | cut -d " " -f 1 | tr -d "/tcp" | > results.xml;
#what we have done here is we will opened the base.txt file and seperated the open ports , cut the distance between them and seperated the /tcp from the results and saved the results to result.txt#	
	nmap -T4 -Pn -sV -p-  -A $(cat results.xml) -A $1  -oX result.xml;
	rm base.xml
	rm results.xml
#the output will be in the .xml format don't be confused to check the results#
	searchsploit -x --nmap "result.xml" -j 
#here i have added a extra line which refers to expliot-db (searchsploit) so by this you can simply skip the steps to finding exploits for the results#
#here we removed the extra files base,results files and just kept the files which are useful# 
fi

